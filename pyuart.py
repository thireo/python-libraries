#! /usr/env/python

import serial
from time import sleep


init = "525721064000f40800000c060610005184461eb5f80610005188460c4617061000518cf00246100610005190283ffab70610005194484cd031061000519889808821061000519cd005280006100051a04d4a1d8206100051a4d103429106100051a8e010240206100051ace7f8220006100051b0d004280006100051b442911c8206100051b82400d10306100051bc2200e00706100051c02800e7f906100051c41d00d00006100051c8d10a428106100051cc4840240106100051d02301680006100051d4463ab28106100051d8f002483e06100051dc7004fa9706100051e02306e00906100051e44631463a06100051e8f002483b06100051ec8821fa8f06100051f02180800106100051f46829710106100051f82000478806100051fcb5ffbdf80610005200460cb0810610005204f00298030610005208283ffa7b061000520c9803d03606100052100a00782206100052142600020106100052184d2b482f061000521c2a00310906100052202702d0050610005224d0172a010610005228d1272a02061000522c8862e0290610005230b2931d920610005234f0029a0306100052384607fa69061000523c280089a806100052401c80d0000610005244713e80380610005248807a8862061000524c1d781d210610005250fa62f0020610005254e00e463806100052589a032308061000525cfa56f0020610005260290089a906100052641d09d000061000526871068001061000526c8862804706100052700a127142061000527449157182061000527847886809061000527cb00520000610005280230ebdf00610005284f0029a03061000528889a9fa41061000528cd0002900061000529080011d89061000529421087106061000529888628041061000529c0a12714206100052a088a2718206100052a40a1271c206100052a888e2720206100052ac0a12724206100052b08922728206100052b40a1272c206100052b8e7dc730206100052bc4907b51006100052c0f002201406100052c4bd10fa2f06100052c8100408e406100052cc100400e406100052d01004001806100052d400000e0a06100052d800000c1406100052dc10007c4406100052e04610b51006100052e4f002460c06100052e8cc07fa0b06100052ecffdaf00106100052f0bd10200006100052f44614b57006100052f8f002461006100052fc2306fa010610005300210446220610005304f002482406100053084604fa01061000530cf001200006100053104605fce506100053141ca021040610005318fa0af002061000531c122970a50610005320120970e1061000532412097121061000532820017161061000532c2000706006100053307020491a061000533446206809061000533820004788061000533cb570bd700610005340461046140610005344f9dcf002061000534823064813061000534c210446220610005350f0021c4006100053544604f9db0610005358f0012000061000535c4605fd4706100053601ca021040610005364f9e4f00206100053680a2970a5061000536c0a0970e106100053700a097121061000537420017161061000537820007060061000537c702049070610005380462068090610005384200047880610005388b510bd70061000538c201549040610005390f9c8f00206100053940000bd10061000539800003801061000539c100400e406100053a010007c8406100053a42001b51c06100053a8f9c8f00206100053acf9ccf00206100053b06800484406100053b44d44478006100053b807407b2806100053bc28030f4006100053c04942d80306100053c46809200006100053c84841478806100053cc2600780106100053d0d00e290006100053d4ca06a23f06100053d89100920106100053dc2200700606100053e04668210506100053e4f9b6f00206100053e82105220006100053ecf002466806100053f068a8f9b706100053f4d403004006100053f87801483806100053fcd0fc29000610005400f9b4f0020610005404f9b8f0020610005408f9bcf002061000540c4c3449350610005410686068090610005414493447880610005418f0022003061000541cf000f9b9061000542068a0fbe9061000542468a847800610005428d40a0040061000542c2801782006100054307860d1fc0610005434d00428000610005438492d7066061000543c60c8482b0610005440f002e7fe0610005444f7fff9ab0610005448f7ffff39061000544c4829ff9e06100054504780680006100054544828b6620610005458f9a6f002061000545c07007b280610005460f002d50106100054644c25f9a7061000546815a56860061000546c606043a8061000547020064923061000547447886809061000547843286860061000547c68a060600610005480430801e906100054844c1f60a00610005488f99af002061000548c478068200610005490d0f928000610005494f002481c0610005498e7f5f999061000549c2000460106100054a0d00d290006100054a4d107290206100054a8780a490c06100054acd0042a0206100054b02901780906100054b44815d10006100054b84814477006100054bc4770301006100054c04770481306100054c41004016006100054c81004082806100054cc100401c006100054d01004002506100054d454554f4206100054d80000002106100054dc100400d906100054e01004000006100054e41004010406100054e810005e1d06100054ec05fa000406100054f0e000ed0006100054f41004015406100054f8100403bc06100054fc4000f40006100055001004021006100055041004010c0610005508100405ec061000550c10007bb006100055100001e2bc06100055144addb5f0061000551849dd6816061000551c48dd4bdd0610005520128c334006100055242e0012cd06100055286886d026061000552c400e685706100055300fff073f06100055344337047f0610005538689e6087061000553c6851400e06100055400fc90709061000554443310449061000554869416099061000554c4021685306100055500fdb075b0610005554430b01db061000555869416143061000555c4029685306100055600fdb079b0610005564430b019b061000556849cb6143061000556c400b6943061000557007c968510610005574e02e0fc9061000557868d64ac8061000557c07f60d76061000558068d6d12c061000558407f60d3606100055886886d028061000558c400e68d706100055900fff033f06100055944337047f0610005598689e6087061000559c68d1400e06100055a00fc9030906100055a44331044906100055a86941609906100055ac402168d306100055b00fdb04db06100055b4430b01db06100055b86941614306100055bc402968d306100055c00fdb051b06100055c4430b019b06100055c849b3614306100055cc400b694306100055d0054968d106100055d403c90fc906100055d86141431906100055dc4770bdf006100055e049afb53006100055e46108200006100055e8684849ae06100055ec4310220106100055f049ad604806100055f4158a698806100055f86188439006100055fc680048ab0610005600d1042800061000560469184baa061000560843202404061000560c69086118061000561078254ca8061000561402db23030610005618d1002d01061000561c25e14398061000562043a803ad061000562468c86108061000562878242502061000562c2c0143a80610005630241cd1010610005634242043a00610005638439043a0061000563c43984a9e061000564060c8439006100056444f9dbd30061000564826004c9d061000564c478068380610005650d10d2800061000565428027a200610005658f002d00a061000565c2802f8bd0610005660f002d0fb06100056642800f8b90610005668bf00d102061000566c72202001061000567025007a200610005674d03b28000610005678d04e2801061000567cd1e528020610005680880048900610005684d002280006100056886800488f061000568cf002478006100056907860f8a90610005694d00128000610005698f8aaf002061000569cf8aef00206100056a020016aa106100056a4f002478806100056a84888f8af06100056ac4780680006100056b06800488706100056b44879478006100056b8074068c006100056bc28030f4006100056c04984d80306100056c46809200106100056c878a0478806100056cc70a01c4006100056d06800488106100056d46a20478006100056d8d001280006100056dc47806a2006100056e0ff7ef7ff06100056e42001497d06100056e86188680906100056ece01bb66206100056f0280079e006100056f4bf30d10006100056f878284d7906100056fcd1a528010610005700f888f0020610005704f002702e06100057084876f88b061000570c2800680006100057104874d19c0610005714f848f00206100057182004e798061000571cf886f0020610005720478068380610005724d00128000610005728e78f7226061000572cf884f0020610005730f888f0020610005734d1fb28000610005738f86cf002061000573cf888f002061000574028027a2006100057442002d043061000574848677220061000574c07c1680006100057502101d0050610005754430d044906100057581c497921061000575c0780712106100057606960d4020610005764d0052800061000576804802001061000576c79604305061000577071601c40061000577404002001061000577870664305061000577c495b78e0061000578070e01c4006100057842001680906100057884f444788061000578c28017c3806100057902000d0200610005794432849560610005798f0024308061000579c743ef85f06100057a020006aa106100057a44840478806100057a82202698106100057ac6181431106100057b06981485006100057b4439122c006100057b86981618106100057bc4391158206100057c04c4d618106100057c44780682006100057c8d1fb280006100057ccf002e7fe06100057d0e73bf82706100057d40240200106100057d8b510e7dc06100057dc8410f3ef06100057e0b6724a4606100057e46850681106100057e823001c4906100057ec6011415806100057f0f001605006100057f4b662ff3b06100057f88810f38406100057fcb510bd100610005800207c493f06100058044a21604806100058087a11483e061000580cd10e29010610005810493d4b3e06100058144b3e8019061000581861592101061000581c21044b3d0610005820493d80190610005824493d6001061000582821006041061000582c68d372110610005830680c491e0610005834d01842a3061000583860d3680b061000583c4a38680b06100058402b00493806100058444b38d00706100058484a388013061000584c4a3860c206100058504a38610206100058544b38e00606100058584a388013061000585c4a3860c206100058604a"
init_bytes = bytearray.fromhex(init)

init_rsp = "05010d10000d00000005000d10000d000200010005000d10000d000200030005080d10000d000700f412fa05f0f80005000d10000d000200060005000d10000d00020003000529031000030001000005010b10000b00040007000000050d0b10000b00040009000000050d0b10000b0004000a000000050d0b10000b0004000d000000050d0b10000b0004000e000000050d0b10000b00040011000000050d0b10000b00040012000000050d0b10000b00040015000000050d0b10000b00040016000000050d0b10000b00040019000000050d0b10000b0004001a000000050d0b10000b0004001d000000050d0b10000b0004001e000000"
init_rsp_bytes = bytearray.fromhex(init)

battery_package_tx = {0x05,0x0C,0x0B,0xB,0x00,0x10,0x00,0x06,0x00,0x11,0x00,0x02,0x00,0xD0,0x02}



with serial.Serial('COM25',115200,parity=serial.PARITY_NONE,rtscts=0) as ser:
    
    
    for i in range(100):
        #ser.write('Hello world'.encode('utf-8'))
        '''for c in battery_package_tx:
            ser.write(c)
            ser.flush()'''
        print(ser.write(init_bytes))
        
        print(ser.read_all().hex())
        
        sleep(1)
        print(i)

        